"[{"time":60,"weight":2,"source":"slide","id":"5dc1b12e-bbeb-4565-831b-9d7da8ad2141","text":"Logistic regression in R fit glm(y xl + x2, family=binomial, data=df) • Bernoulli is equivalent to Binomial with only two levels. • First (alphabetical) level is set to 0, other to 1. Use relevel if you want to change it. • glm uses MLE with a logit link function (when family=binomial). 6 "},{"time":180,"weight":2,"source":"slide","id":"5dc1b12e-bbeb-4565-831b-9d7da8ad2141","text":"Partial residual plots Let ei = — be a response residual. Then Pi(l — Pi) is the \"logit residual\" (compare Pearson residuals). • The \"logit partial residual\" for thejth variable is We can plot these against xj to identify potential nonlinearity. • car: :crP10ts implements them 12 "},{"time":240,"weight":2,"source":"slide","id":"5dc1b12e-bbeb-4565-831b-9d7da8ad2141","text":"Component + Residual Plots "},{"time":120,"weight":2,"source":"slide","id":"5dc1b12e-bbeb-4565-831b-9d7da8ad2141","text":"File Edit Code View Plots Session Add ins Environment Files Plots Packages Help Viewer Console -'Dropbox'Teachina'ETC3580-2017,'Week2' "},{"time":300,"weight":2,"source":"slide","id":"5dc1b12e-bbeb-4565-831b-9d7da8ad2141","text":"000000000 "},{"time":360,"weight":2,"source":"slide","id":"5dc1b12e-bbeb-4565-831b-9d7da8ad2141","text":"Partial residual plots Let ei = — be a response residual. Then Pi(l — Pi) is the \"logit residual\" (compare Pearson residuals). • The \"logit partial residual\" for thejth variable is We can plot these against xj to identify potential nonlinearity. • car: :crP10ts implements them 12 "},{"time":420,"weight":2,"source":"slide","id":"5dc1b12e-bbeb-4565-831b-9d7da8ad2141","text":"Deviance Generalization of sum of squared residuals based on likelihood ratio: D = Edi = -2 logL+c where L is the likelihood of the model and c is constant that depends on data but not model. • Difference between deviances equivalent to a likelihood ratio test. DI — D2 X2 where q is df for model i assuming a smaller model is correct models are nested distributional assumptions true Null deviance is for model with only an intercept. "},{"time":480,"weight":2,"source":"slide","id":"5dc1b12e-bbeb-4565-831b-9d7da8ad2141","text":"Deviance Generalization of sum of squared residuals based on likelihood ratio: D = Edi = -2 logL+c where L is the likelihood of the model and c is constant that depends on data but not model. • Difference between deviances equivalent to a likelihood ratio test. DI — D2 X2 where q is df for model i assuming smaller model is correct models are nested distributional assumptions true Null deviance is for model with only an intercept. "},{"time":600,"weight":2,"source":"slide","id":"5dc1b12e-bbeb-4565-831b-9d7da8ad2141","text":"File Edit Code View Plots Environment Files Plots Packages Help Zoom Export "},{"time":540,"weight":2,"source":"slide","id":"5dc1b12e-bbeb-4565-831b-9d7da8ad2141","text":"Deviance Generalization of sum of squared residuals based on likelihood ratio: D = Edi = -2 logL+c where L is the likelihood of the model and c is constant that depends on data but not model. • Difference between deviances equivalent to a likelihood ratio test. DI — D2 X2 where q is df for model i assuming smaller model is correct models are nested distributional assumptions true Null deviance is for model with only an intercept. "},{"time":780,"weight":2,"source":"slide","id":"5dc1b12e-bbeb-4565-831b-9d7da8ad2141","text":"File Edit Code View Plots Environment Files Plots Packages Help Zoom Export "},{"time":840,"weight":2,"source":"slide","id":"5dc1b12e-bbeb-4565-831b-9d7da8ad2141","text":"File Edit Code View Plots Session Add ins Environment Files Plots Packages Help Viewer Console -'Dropbox'Teachinq'ETC3580-2017,'Week2' "},{"time":900,"weight":2,"source":"slide","id":"5dc1b12e-bbeb-4565-831b-9d7da8ad2141","text":"File Edit Code View Plots Session Add ins Environment Files Plots Packages Help Viewer Console -'Dropbox'Teachinq'ETC3580-2017,'Week2/ "},{"time":960,"weight":2,"source":"slide","id":"5dc1b12e-bbeb-4565-831b-9d7da8ad2141","text":"File Edit Code View Plots Session Add ins Environment Files Plots Packages Help Viewer Console -'Dropbox1Teachina'ETC3580-2017,'Week2' Deviance Residuals: "},{"time":1020,"weight":2,"source":"slide","id":"5dc1b12e-bbeb-4565-831b-9d7da8ad2141","text":"File Edit Code View Plots "},{"time":1080,"weight":2,"source":"slide","id":"5dc1b12e-bbeb-4565-831b-9d7da8ad2141","text":"File Edit Code View Plots Environment Files Plots Packages Help "},{"time":1200,"weight":2,"source":"slide","id":"5dc1b12e-bbeb-4565-831b-9d7da8ad2141","text":"File Edit Code View Plots Environment Files Plots Packages Help R: Voting Intentions in the 1988 Chilean Plebiscite income Monthly income, in Pesos. statusquo Scale of support for the status-quo. vote "},{"time":1260,"weight":2,"source":"slide","id":"5dc1b12e-bbeb-4565-831b-9d7da8ad2141","text":"File Edit Code View Plots Session Add ins Environment Files Plots Packages Help Viewer Console -'Dropbox'Teachina'ETC3580-2017,'Week2/ data = chile) Deviance Residuals: "},{"time":1320,"weight":2,"source":"slide","id":"5dc1b12e-bbeb-4565-831b-9d7da8ad2141","text":"DI Ate ' ilA Drr'fila Component + Residual Plots "},{"time":1380,"weight":2,"source":"slide","id":"5dc1b12e-bbeb-4565-831b-9d7da8ad2141","text":"File Edit Code View Plots Session Add ins Environment Files Plots Packages Help Viewer Console -'Dropbox/Teachina'ETC3580-2017,'Week2/ "},{"time":1440,"weight":2,"source":"slide","id":"5dc1b12e-bbeb-4565-831b-9d7da8ad2141","text":"Confidence intervals for coefficients Standard intervals based on normal distribution are poor approximations. Better to use \"profile likelihood\" confidence intervals Let Lp(9) be the profile likelihood (the likelihood without the nuisance parameters). LR test for Ho : O = 90 is LR = 2 [log Lp(Ö) — log Lp(00)] Confidence interval consists of those values 90 for which test is not significant. (A contour region of the likelihood.) Implemented in R using conf int "},{"time":1500,"weight":2,"source":"slide","id":"5dc1b12e-bbeb-4565-831b-9d7da8ad2141","text":"File Edit Code View Plots Session Add ins Environment Files Plots Packages Help Viewer Console -'Dropbox1Teachina'ETC3580-2017,'Week2/ "},{"time":1560,"weight":2,"source":"slide","id":"5dc1b12e-bbeb-4565-831b-9d7da8ad2141","text":"File Edit Code View Plots Session Add ins Environment Files Plots Packages Help Viewer Console -'Dropbox/Teachina'ETC3580-2017,'Week2/ "},{"time":1620,"weight":2,"source":"slide","id":"5dc1b12e-bbeb-4565-831b-9d7da8ad2141","text":"Latent variable interpretation Suppose z is a latent (unobserved) random variable: + + • • • + /3qXq + E > O O otherwise where E has cdf F. If Fis \"standard logistic\", then F(w) = 1/[1 + e So logit(p) = + + • • • + ßqxq. That is, we can think of logistic regression as an ordinary regression with logistic noise, and we observe only if it is above or below O. "},{"time":1680,"weight":2,"source":"slide","id":"5dc1b12e-bbeb-4565-831b-9d7da8ad2141","text":"Latent variable interpretation Suppose z is a latent (unobserved) random variable: + ß1X1 + • • • + ßqxq + E > 0 O otherwise where E has cdf F. If Fis \"standard logistic\", then F(w) = 1/[1 + e So logit(p) = + + • • • + ßqxq. That is, we can think of logistic regression as an ordinary regression with logistic noise, and we observe only if it is above or below O. "},{"time":1740,"weight":2,"source":"slide","id":"5dc1b12e-bbeb-4565-831b-9d7da8ad2141","text":"Latent variable interpretation • Suppose z is a latent (unobserved) random variable: {30 + + • • + ßqxq + E > 0 O otherwise where E has cdf F. If F is \"standard logistic\", tlben F(w) = 1/[1 + e So logit(p) = + + • • • + ßqxq. That is, we can think of logistic regression as an ordinary regression with logistic noise, and we observe only if it is above or below O. "},{"time":1800,"weight":2,"source":"slide","id":"5dc1b12e-bbeb-4565-831b-9d7da8ad2141","text":"Latent variable interetation General binary model Pi = = P(Yi = 1) = + 1 + • • • + h3qXi q where g maps IR + (O, 1). "},{"time":1860,"weight":2,"source":"slide","id":"5dc1b12e-bbeb-4565-831b-9d7da8ad2141","text":"Latent variable interetation General binary model Pi = = P(Yi = 1) = + 1 + • • • + h3qXi q where g maps IR + (O, 1). • g(o) = eo/(l + eti): logit link, logistic regression g(o) = (DO): normal cdf link, probit regression • g(o) = 1 — exp(— exp(o)): log-log link fit <- glm(y xl + x2, family=binomial (link=probit) , data=df) 21 "},{"time":1920,"weight":2,"source":"slide","id":"5dc1b12e-bbeb-4565-831b-9d7da8ad2141","text":"File Edit Code View Plots Session Add ins Environment Files Plots Packages Help Viewer Console -'Dropbox1Teachinq'ETC3580-2017,'Week2/ "},{"time":2040,"weight":2,"source":"slide","id":"5dc1b12e-bbeb-4565-831b-9d7da8ad2141","text":"Why prefer logit over probit? • odds ratio interpretation of coefficients non-biased with disproportionate stratified sampling. Only link function with this property. non-biased with clustered observations. Only link function with this property. • logit link is \"canonical\": ensures EXijYi q) are sufficient for estimation. So p-values are exact. 22 "},{"time":2100,"weight":2,"source":"slide","id":"5dc1b12e-bbeb-4565-831b-9d7da8ad2141","text":"Outline Binomial responses 23 "},{"time":2280,"weight":2,"source":"slide","id":"5dc1b12e-bbeb-4565-831b-9d7da8ad2141","text":"Binomial responses • Yis binomially distributed B(m, p) if m pY(1 — Y Y = number of \"successes\" in m independent trials, each with probability p of success. Binomial regression also uses a logit link "},{"time":2400,"weight":2,"source":"slide","id":"5dc1b12e-bbeb-4565-831b-9d7da8ad2141","text":"File Edit Code View Plots Session Add ins Environment Files Plots Packages Help Viewer Console -'Dropbox.'Teachina'ETC3580-2017,'Week2/ Signif. codes: O 0.001 0.01 e.e5 "},{"time":2460,"weight":2,"source":"slide","id":"5dc1b12e-bbeb-4565-831b-9d7da8ad2141","text":"File Edit Code View Plots Session Add ins Environment Files Plots Packages Help Viewer Console -'Dropbox'Teachina'ETC3580-2017,'Week2' "},{"time":2520,"weight":2,"source":"slide","id":"5dc1b12e-bbeb-4565-831b-9d7da8ad2141","text":"File Edit Code View Plots Environment Files Plots Packages Help Zoom Export • "},{"time":2340,"weight":2,"source":"slide","id":"5dc1b12e-bbeb-4565-831b-9d7da8ad2141","text":"Binomial responses • glm needs a two-column matrix of success and failures. (So rows sum to m). fit <- glm(cbind(successes,failures) xl + x2, family=binomial, data=df) Everything else works the same as for binary regression. 25 "},{"time":2640,"weight":2,"source":"slide","id":"5dc1b12e-bbeb-4565-831b-9d7da8ad2141","text":"File Edit Code View Plots Session Build Debug Add ins "},{"time":2580,"weight":2,"source":"slide","id":"5dc1b12e-bbeb-4565-831b-9d7da8ad2141","text":"File Edit Code View Plots Session Add ins Environment Files Plots Packages Help Viewer Console -'Dropbox1Teachina'ETC3580-2017,'Week2' 5 66 6 67 > :ortngs) + mutate( pdamage + O ngS orings # A tibbte: 23 x 4 "},{"time":2700,"weight":2,"source":"slide","id":"5dc1b12e-bbeb-4565-831b-9d7da8ad2141","text":"Session Add ins Viewer "},{"time":2760,"weight":2,"source":"slide","id":"5dc1b12e-bbeb-4565-831b-9d7da8ad2141","text":"Overdisperson • If mean correctly modelled, but observed variance larger than model, we called the data \"overdispersed [Same for underdispersion.] Concept of overdispersion irrelevant for OLS and logistic regression because there cannot be any more variance than what is modelled. • For binomial regression: B(mi, Pi), E(yD = miPi, V(yD = rnpj(l — Pi). 2 If model correct, D Xn q So D > n — q indicates overdisperson. 26 "},{"time":2820,"weight":2,"source":"slide","id":"5dc1b12e-bbeb-4565-831b-9d7da8ad2141","text":"Overdisperson • If mean correctly modelled, but observed variance larger than model, we called the data \"overdispersed [Same for underdispersion.] Concept of overdispersion irrelevant for OLS and logistic regression because there cannot be any more variance than what is modelled. • For binomial regression: B(mi, Pi), E(yD = miPi, V(yD = rnpj(l — Pi). model correct, D x n q 2 So D > n — q indicates overdisperson. 26 "},{"time":2880,"weight":2,"source":"slide","id":"5dc1b12e-bbeb-4565-831b-9d7da8ad2141","text":"File Edit Code View Plots Session Add ins Environment Files Plots Packages Help Viewer "},{"time":2940,"weight":2,"source":"slide","id":"5dc1b12e-bbeb-4565-831b-9d7da8ad2141","text":"Overdisperson D > n — q can also be the result of: missing covariates or interaction terms • negligence of non-linear effects • large outliers sampling from clusters non-independence m small (X2 approximation fails) "},{"time":3000,"weight":2,"source":"slide","id":"5dc1b12e-bbeb-4565-831b-9d7da8ad2141","text":"Overdisperson Solution 1: Drop strict binomial assumption and let E(yD = rniPi, V(yD = — Pi). Pearson residuals Yi — rniPi rniPi(1 — Pi) Simple estimate of dispersion parameter Estimate OK for estimation and standard errors on coefficients. 28 But no proper inference via deviance. "},{"time":3060,"weight":2,"source":"slide","id":"5dc1b12e-bbeb-4565-831b-9d7da8ad2141","text":"Overdisperson Solution 2: Define a \"quasi-likelihood\" that behaves like the log-likelihood but allows for V(yD = +rnpi(l — Pi). fit <- glm(cbind(successes,failures) xl + x2, family=quasibinomial, data=df) Must use F-tests rather than X2 tests for comparing models. 29 "},{"time":3180,"weight":2,"source":"slide","id":"5dc1b12e-bbeb-4565-831b-9d7da8ad2141","text":"File Edit Code View Plots "},{"time":3120,"weight":2,"source":"slide","id":"5dc1b12e-bbeb-4565-831b-9d7da8ad2141","text":"File Edit Code View Plots Session Add ins Environment Files Plots Packages Help Viewer "}]"
